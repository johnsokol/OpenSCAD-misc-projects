
scale([.4,.4,1])
difference()
{

union() {
difference() {
koch_three_snowflake(12,3);
translate([0,0,-1])
koch_three_snowflake(7,5);
}

difference()
{
koch_three_snowflake(5,3);
translate([0,0,-1])
koch_three_snowflake(3,5);
}


koch_three_snowflake(2,3);


 for( j = [
           [0,0,2],
          [0,0,62],
                   [0,0,122],
         [0,0,182],
                    [0,0,242],
        [0,0,302]
                    ])
{
rotate(j)
cube (size=[4,90,3],center=false);
}
}


translate([0,0,-1])
koch_three_snowflake(1,5);

 translate([0,0,-1])
 rotate([0,0,30])
  rot1(80,1,5);
}




 module rot1(rr1,sc,ht)
{

for ( i = [
           [ rr1,0,0 ],
           [ .5*rr1, (sqrt(3)/2)*rr1,0],
           [-0.5*rr1,(sqrt(3)/2)*rr1,0],
           [- rr1,0,0 ],
           [-0.5*rr1, -(sqrt(3)/2)*rr1,0],
           [0.5*rr1,-(sqrt(3)/2)*rr1,0],
           ])
           {

            translate(i)
             koch_three_snowflake(sc,ht);
 }

 }


module koch_three_snowflake(sc,ht)
{


 scale([sc,sc,1])
linear_extrude(height=ht)
polygon
       (points = [
          [ 8.00000,-4.61880],[ 7.40741,-4.61880],[ 7.40741,-4.61880],[ 7.11111,-5.13200],[ 7.11111,-5.13200],
          [ 6.81482,-4.61880],[ 6.81482,-4.61880],[ 6.22222,-4.61880],[ 6.22222,-4.61880],[ 5.92593,-5.13200],
          [ 5.92593,-5.13200],[ 6.22222,-5.64520],[ 6.22222,-5.64520],[ 5.62963,-5.64520],[ 5.62963,-5.64520],
          [ 5.33333,-6.15840],[ 5.33333,-6.15840],[ 5.03704,-5.64520],[ 5.03704,-5.64520],[ 4.44444,-5.64520],
          [ 4.44444,-5.64520],[ 4.74074,-5.13200],[ 4.74074,-5.13200],[ 4.44444,-4.61880],[ 4.44444,-4.61880],
          [ 3.85185,-4.61880],[ 3.85185,-4.61880],[ 3.55556,-5.13200],[ 3.55556,-5.13200],[ 3.25926,-4.61880],
          [ 3.25926,-4.61880],[ 2.66667,-4.61880],[ 2.66667,-4.61880],[ 2.37037,-5.13200],[ 2.37037,-5.13200],
          [ 2.66667,-5.64520],[ 2.66667,-5.64520],[ 2.07407,-5.64520],[ 2.07407,-5.64520],[ 1.77778,-6.15840],
          [ 1.77778,-6.15840],[ 2.07407,-6.67160],[ 2.07407,-6.67160],[ 2.66667,-6.67160],[ 2.66667,-6.67160],
          [ 2.37037,-7.18480],[ 2.37037,-7.18480],[ 2.66667,-7.69800],[ 2.66667,-7.69800],[ 2.07407,-7.69800],
          [ 2.07407,-7.69800],[ 1.77778,-8.21120],[ 1.77778,-8.21120],[ 1.48148,-7.69800],[ 1.48148,-7.69800],
          [ 0.88889,-7.69800],[ 0.88889,-7.69800],[ 0.59259,-8.21120],[ 0.59259,-8.21120],[ 0.88889,-8.72440],
          [ 0.88889,-8.72440],[ 0.29630,-8.72440],[ 0.29630,-8.72440],[ 0.00000,-9.23760],[ 0.00000,-9.23760],
          [-0.29630,-8.72440],[-0.29630,-8.72440],[-0.88889,-8.72440],[-0.88889,-8.72440],[-0.59259,-8.21120],
          [-0.59259,-8.21120],[-0.88889,-7.69800],[-0.88889,-7.69800],[-1.48148,-7.69800],[-1.48148,-7.69800],
          [-1.77778,-8.21120],[-1.77778,-8.21120],[-2.07407,-7.69800],[-2.07407,-7.69800],[-2.66667,-7.69800],
          [-2.66667,-7.69800],[-2.37037,-7.18480],[-2.37037,-7.18480],[-2.66667,-6.67160],[-2.66667,-6.67160],
          [-2.07407,-6.67160],[-2.07407,-6.67160],[-1.77778,-6.15840],[-1.77778,-6.15840],[-2.07407,-5.64520],
          [-2.07407,-5.64520],[-2.66667,-5.64520],[-2.66667,-5.64520],[-2.37037,-5.13200],[-2.37037,-5.13200],
          [-2.66667,-4.61880],[-2.66667,-4.61880],[-3.25926,-4.61880],[-3.25926,-4.61880],[-3.55556,-5.13200],
          [-3.55556,-5.13200],[-3.85185,-4.61880],[-3.85185,-4.61880],[-4.44444,-4.61880],[-4.44444,-4.61880],
          [-4.74074,-5.13200],[-4.74074,-5.13200],[-4.44444,-5.64520],[-4.44444,-5.64520],[-5.03704,-5.64520],
          [-5.03704,-5.64520],[-5.33333,-6.15840],[-5.33333,-6.15840],[-5.62963,-5.64520],[-5.62963,-5.64520],
          [-6.22222,-5.64520],[-6.22222,-5.64520],[-5.92593,-5.13200],[-5.92593,-5.13200],[-6.22222,-4.61880],
          [-6.22222,-4.61880],[-6.81482,-4.61880],[-6.81482,-4.61880],[-7.11111,-5.13200],[-7.11111,-5.13200],
          [-7.40741,-4.61880],[-7.40741,-4.61880],[-8.00000,-4.61880],[-8.00000,-4.61880],[-7.70370,-4.10560],
          [-7.70370,-4.10560],[-8.00000,-3.59240],[-8.00000,-3.59240],[-7.40741,-3.59240],[-7.40741,-3.59240],
          [-7.11111,-3.07920],[-7.11111,-3.07920],[-7.40741,-2.56600],[-7.40741,-2.56600],[-8.00000,-2.56600],
          [-8.00000,-2.56600],[-7.70370,-2.05280],[-7.70370,-2.05280],[-8.00000,-1.53960],[-8.00000,-1.53960],
          [-7.40741,-1.53960],[-7.40741,-1.53960],[-7.11111,-1.02640],[-7.11111,-1.02640],[-6.81482,-1.53960],
          [-6.81482,-1.53960],[-6.22222,-1.53960],[-6.22222,-1.53960],[-5.92593,-1.02640],[-5.92593,-1.02640],
          [-6.22222,-0.51320],[-6.22222,-0.51320],[-5.62963,-0.51320],[-5.62963,-0.51320],[-5.33333,-0.00000],
          [-5.33333,-0.00000],[-5.62963, 0.51320],[-5.62963, 0.51320],[-6.22222, 0.51320],[-6.22222, 0.51320],
          [-5.92593, 1.02640],[-5.92593, 1.02640],[-6.22222, 1.53960],[-6.22222, 1.53960],[-6.81482, 1.53960],
          [-6.81482, 1.53960],[-7.11111, 1.02640],[-7.11111, 1.02640],[-7.40741, 1.53960],[-7.40741, 1.53960],
          [-8.00000, 1.53960],[-8.00000, 1.53960],[-7.70370, 2.05280],[-7.70370, 2.05280],[-8.00000, 2.56600],
          [-8.00000, 2.56600],[-7.40741, 2.56600],[-7.40741, 2.56600],[-7.11111, 3.07920],[-7.11111, 3.07920],
          [-7.40741, 3.59240],[-7.40741, 3.59240],[-8.00000, 3.59240],[-8.00000, 3.59240],[-7.70370, 4.10560],
          [-7.70370, 4.10560],[-8.00000, 4.61880],[-8.00000, 4.61880],[-7.40741, 4.61880],[-7.40741, 4.61880],
          [-7.11111, 5.13200],[-7.11111, 5.13200],[-6.81482, 4.61880],[-6.81482, 4.61880],[-6.22222, 4.61880],
          [-6.22222, 4.61880],[-5.92593, 5.13200],[-5.92593, 5.13200],[-6.22222, 5.64520],[-6.22222, 5.64520],
          [-5.62963, 5.64520],[-5.62963, 5.64520],[-5.33333, 6.15840],[-5.33333, 6.15840],[-5.03704, 5.64520],
          [-5.03704, 5.64520],[-4.44445, 5.64520],[-4.44445, 5.64520],[-4.74074, 5.13200],[-4.74074, 5.13200],
          [-4.44444, 4.61880],[-4.44444, 4.61880],[-3.85185, 4.61880],[-3.85185, 4.61880],[-3.55556, 5.13200],
          [-3.55556, 5.13200],[-3.25926, 4.61880],[-3.25926, 4.61880],[-2.66667, 4.61880],[-2.66667, 4.61880],
          [-2.37037, 5.13200],[-2.37037, 5.13200],[-2.66667, 5.64520],[-2.66667, 5.64520],[-2.07407, 5.64520],
          [-2.07407, 5.64520],[-1.77778, 6.15840],[-1.77778, 6.15840],[-2.07407, 6.67160],[-2.07407, 6.67160],
          [-2.66667, 6.67160],[-2.66667, 6.67160],[-2.37037, 7.18480],[-2.37037, 7.18480],[-2.66667, 7.69800],
          [-2.66667, 7.69800],[-2.07407, 7.69800],[-2.07407, 7.69800],[-1.77778, 8.21120],[-1.77778, 8.21120],
          [-1.48148, 7.69800],[-1.48148, 7.69800],[-0.88889, 7.69800],[-0.88889, 7.69800],[-0.59259, 8.21120],
          [-0.59259, 8.21120],[-0.88889, 8.72440],[-0.88889, 8.72440],[-0.29630, 8.72440],[-0.29630, 8.72440],
          [ 0.00000, 9.23760],[ 0.00000, 9.23760],[ 0.29630, 8.72440],[ 0.29630, 8.72440],[ 0.88889, 8.72440],
          [ 0.88889, 8.72440],[ 0.59259, 8.21120],[ 0.59259, 8.21120],[ 0.88889, 7.69800],[ 0.88889, 7.69800],
          [ 1.48148, 7.69800],[ 1.48148, 7.69800],[ 1.77778, 8.21120],[ 1.77778, 8.21120],[ 2.07407, 7.69800],
          [ 2.07407, 7.69800],[ 2.66667, 7.69800],[ 2.66667, 7.69800],[ 2.37037, 7.18480],[ 2.37037, 7.18480],
          [ 2.66667, 6.67160],[ 2.66667, 6.67160],[ 2.07407, 6.67160],[ 2.07407, 6.67160],[ 1.77778, 6.15840],
          [ 1.77778, 6.15840],[ 2.07407, 5.64520],[ 2.07407, 5.64520],[ 2.66667, 5.64520],[ 2.66667, 5.64520],
          [ 2.37037, 5.13200],[ 2.37037, 5.13200],[ 2.66667, 4.61880],[ 2.66667, 4.61880],[ 3.25926, 4.61880],
          [ 3.25926, 4.61880],[ 3.55556, 5.13200],[ 3.55556, 5.13200],[ 3.85185, 4.61880],[ 3.85185, 4.61880],
          [ 4.44444, 4.61880],[ 4.44444, 4.61880],[ 4.74074, 5.13200],[ 4.74074, 5.13200],[ 4.44444, 5.64520],
          [ 4.44444, 5.64520],[ 5.03704, 5.64520],[ 5.03704, 5.64520],[ 5.33333, 6.15840],[ 5.33333, 6.15840],
          [ 5.62963, 5.64520],[ 5.62963, 5.64520],[ 6.22222, 5.64520],[ 6.22222, 5.64520],[ 5.92593, 5.13200],
          [ 5.92593, 5.13200],[ 6.22222, 4.61880],[ 6.22222, 4.61880],[ 6.81481, 4.61880],[ 6.81481, 4.61880],
          [ 7.11111, 5.13200],[ 7.11111, 5.13200],[ 7.40741, 4.61880],[ 7.40741, 4.61880],[ 8.00000, 4.61880],
          [ 8.00000, 4.61880],[ 7.70370, 4.10560],[ 7.70370, 4.10560],[ 8.00000, 3.59240],[ 8.00000, 3.59240],
          [ 7.40741, 3.59240],[ 7.40741, 3.59240],[ 7.11111, 3.07920],[ 7.11111, 3.07920],[ 7.40741, 2.56600],
          [ 7.40741, 2.56600],[ 8.00000, 2.56600],[ 8.00000, 2.56600],[ 7.70370, 2.05280],[ 7.70370, 2.05280],
          [ 8.00000, 1.53960],[ 8.00000, 1.53960],[ 7.40741, 1.53960],[ 7.40741, 1.53960],[ 7.11111, 1.02640],
          [ 7.11111, 1.02640],[ 6.81481, 1.53960],[ 6.81481, 1.53960],[ 6.22222, 1.53960],[ 6.22222, 1.53960],
          [ 5.92593, 1.02640],[ 5.92593, 1.02640],[ 6.22222, 0.51320],[ 6.22222, 0.51320],[ 5.62963, 0.51320],
          [ 5.62963, 0.51320],[ 5.33333,-0.00000],[ 5.33333,-0.00000],[ 5.62963,-0.51320],[ 5.62963,-0.51320],
          [ 6.22222,-0.51320],[ 6.22222,-0.51320],[ 5.92593,-1.02640],[ 5.92593,-1.02640],[ 6.22222,-1.53960],
          [ 6.22222,-1.53960],[ 6.81482,-1.53960],[ 6.81482,-1.53960],[ 7.11111,-1.02640],[ 7.11111,-1.02640],
          [ 7.40741,-1.53960],[ 7.40741,-1.53960],[ 8.00000,-1.53960],[ 8.00000,-1.53960],[ 7.70370,-2.05280],
          [ 7.70370,-2.05280],[ 8.00000,-2.56600],[ 8.00000,-2.56600],[ 7.40741,-2.56600],[ 7.40741,-2.56600],
          [ 7.11111,-3.07920],[ 7.11111,-3.07920],[ 7.40741,-3.59240],[ 7.40741,-3.59240],[ 8.00000,-3.59240],
          [ 8.00000,-3.59240],[ 7.70370,-4.10560],[ 7.70370,-4.10560],[ 8.00000,-4.61880],
                ]
      ); }
